{"version":3,"file":"jquery-state-store.umd.js","sources":["../src/index.js"],"sourcesContent":["(function($) {\r\n  var stateStore = {};\r\n  var listeners = {};\r\n  var effects = {};\r\n\r\n  function createReactiveObject(stateName, initialState) {\r\n      return new Proxy(initialState, {\r\n          set(target, key, value) {\r\n              target[key] = value;\r\n              notifyListeners(stateName);\r\n              notifyEffects(stateName);\r\n              return true;\r\n          },\r\n          get(target, key) {\r\n              if (typeof target[key] === 'object' && target[key] !== null) {\r\n                  return createReactiveObject(stateName, target[key]);\r\n              }\r\n              return target[key];\r\n          }\r\n      });\r\n  }\r\n\r\n  function useState(name, initialValue) {\r\n      if (!stateStore.hasOwnProperty(name)) {\r\n          if (typeof initialValue === 'object' && initialValue !== null) {\r\n              stateStore[name] = createReactiveObject(name, initialValue);\r\n          } else {\r\n              stateStore[name] = initialValue;\r\n          }\r\n          listeners[name] = [];\r\n          effects[name] = [];\r\n          bindElements(name);\r\n      } else {\r\n          console.warn(`State \"${name}\" is already registered.`);\r\n      }\r\n  }\r\n\r\n  function getState(path) {\r\n      var keys = path.split('.');\r\n      var state = stateStore;\r\n      for (var i = 0; i < keys.length; i++) {\r\n          if (state[keys[i]] === undefined) {\r\n              return undefined;\r\n          }\r\n          state = state[keys[i]];\r\n      }\r\n      return state;\r\n  }\r\n\r\n  function setState(path, newValue) {\r\n      var keys = path.split('.');\r\n      var state = stateStore;\r\n      for (var i = 0; i < keys.length - 1; i++) {\r\n          if (state[keys[i]] === undefined) {\r\n              state[keys[i]] = {};\r\n          }\r\n          state = state[keys[i]];\r\n      }\r\n      var lastKey = keys[keys.length - 1];\r\n      state[lastKey] = newValue;\r\n      notifyListeners(keys[0]);\r\n      notifyEffects(keys[0]);\r\n  }\r\n\r\n  function reactive(path, listener) {\r\n      var keys = path.split('.');\r\n      var name = keys[0];\r\n      if (listeners.hasOwnProperty(name)) {\r\n          listeners[name].push(listener);\r\n      } else {\r\n          console.warn(`State \"${name}\" is not registered.`);\r\n      }\r\n  }\r\n\r\n  function notifyListeners(name) {\r\n      if (listeners.hasOwnProperty(name)) {\r\n          listeners[name].forEach(function(listener) {\r\n              listener(getState(name));\r\n          });\r\n      }\r\n  }\r\n\r\n  function useEffect(name, effect) {\r\n      var keys = name.split('.');\r\n      var topState = keys[0];\r\n      if (effects.hasOwnProperty(topState)) {\r\n          effects[topState].push({ path: name, effect: effect });\r\n          effect(getState(name));\r\n      } else {\r\n          console.warn(`State \"${name}\" is not registered.`);\r\n      }\r\n  }\r\n\r\n  function notifyEffects(name) {\r\n      if (effects.hasOwnProperty(name)) {\r\n          effects[name].forEach(function(effectObj) {\r\n              effectObj.effect(getState(effectObj.path));\r\n          });\r\n      }\r\n  }\r\n\r\n  function bindElements(stateName) {\r\n      $('[data-bind]').each(function() {\r\n          var element = $(this);\r\n          var bindings = element.data('bind').split(';');\r\n\r\n          bindings.forEach(function(binding) {\r\n              var parts = binding.split(':');\r\n              var directive = parts[0].trim();\r\n              var stateKey = parts[1].trim();\r\n\r\n              if (stateKey.startsWith(stateName)) {\r\n                  switch (directive) {\r\n                      case 'text':\r\n                          reactive(stateKey, function() {\r\n                              element.text(getState(stateKey));\r\n                          });\r\n                          break;\r\n                      case 'html':\r\n                          reactive(stateKey, function() {\r\n                              element.html(getState(stateKey));\r\n                          });\r\n                          break;\r\n                      case 'if':\r\n                          reactive(stateKey, function() {\r\n                              if (getState(stateKey)) {\r\n                                  element.show();\r\n                              } else {\r\n                                  element.hide();\r\n                              }\r\n                          });\r\n                          break;\r\n                      case 'data':\r\n                          reactive(stateKey, function() {\r\n                              element.data('value', getState(stateKey));\r\n                          });\r\n                          break;\r\n                      case 'model':\r\n                          reactive(stateKey, function() {\r\n                              element.val(getState(stateKey));\r\n                          });\r\n                          element.on('input', function() {\r\n                              setState(stateKey, element.val());\r\n                          });\r\n                          break;\r\n                      default:\r\n                          console.warn(`Unknown directive: ${directive}`);\r\n                  }\r\n              }\r\n          });\r\n      });\r\n  }\r\n\r\n  // Expose the functions to the global jQuery object\r\n  $.useState = useState;\r\n  $.getState = getState;\r\n  $.setState = setState;\r\n  $.reactive = reactive;\r\n  $.useEffect = useEffect;\r\n})(jQuery);\r\n\r\n$(document).ready(function() {\r\n  $('[data-bind]').each(function() {\r\n    var element = $(this);\r\n    var bindings = element.data('bind').split(';');\r\n\r\n    bindings.forEach(function(binding) {\r\n        var parts = binding.split(':');\r\n        var directive = parts[0].trim();\r\n        var stateKey = parts[1].trim();\r\n        var initialValue = $.getState(stateKey);\r\n\r\n        switch (directive) {\r\n            case 'text':\r\n                element.text(initialValue);\r\n                break;\r\n            case 'html':\r\n                element.html(initialValue);\r\n                break;\r\n            case 'if':\r\n                if (initialValue) {\r\n                    element.show();\r\n                } else {\r\n                    element.hide();\r\n                }\r\n                break;\r\n            case 'data':\r\n                element.data('value', initialValue);\r\n                break;\r\n            case 'model':\r\n                element.val(initialValue);\r\n                element.on('input', function() {\r\n                    $.setState(stateKey, element.val());\r\n                });\r\n                break;\r\n            default:\r\n                console.warn(`Unknown directive: ${directive}`);\r\n        }\r\n    });\r\n  });\r\n})"],"names":[],"mappings":"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"}